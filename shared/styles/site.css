/* Sitewide font: Palatino */
html { font-size: 16px; }

body {
  margin: 0;
  font-family: "Palatino", "Palatino Linotype", "Book Antiqua", "URW Palladio L", Georgia, serif;
  line-height: 1.6;
  font-size: 1.0625rem;
  color: var(--ink);
  background: linear-gradient(#f8f6f2, var(--paper));
}

/* Leaflet permanent labels */
.map-label {
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid #e7e0d6;
  border-radius: 12px;
  padding: 4px 8px;
  font-size: 14.5px;
  color: #222;
  box-shadow: 0 6px 14px rgba(0,0,0,.08);
}
.leaflet-tooltip-top:before { border-top-color: #e7e0d6; }


:root {
  --paper:#f6f3ee; --sand:#efe9df; --ink:#1f1f1f;
  --muted:#6c6c6c; --accent:#9a7b43; --line:#e6e0d6;
  --radius:18px; --max:980px; --shadow:0 8px 24px rgba(0,0,0,.06);
  --nav-height:72px; --nav-offset:48px;
  --nav-stack:calc(var(--nav-height) + var(--nav-offset));
  --gutter:clamp(24px,6vw,96px);
}
*{box-sizing:border-box}

.wrap{
  width:100%;
  max-width:100%;
  margin:0;
  padding:24px var(--gutter);
}
.nav{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  min-height:var(--nav-height);
  z-index:20;
}
.nav::after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(to bottom,rgba(16,14,12,.55),rgba(16,14,12,0));
  pointer-events:none;
  z-index:0;
}
.nav .wrap{display:flex;justify-content:space-between;align-items:center;position:relative;z-index:1;}
.brand{
  text-decoration:none;
  color:var(--ink);
  font-weight:500;
  font-size:clamp(26px,4vw,34px);
  letter-spacing:0.04em;
  text-shadow:0 2px 6px rgba(0,0,0,.25);
  display:inline-block;
}
.brand span{
  display:inline-block;
  vertical-align:baseline;
  line-height:1;
}
.brand .brand-letter{
  font-weight:600;
  letter-spacing:0;
}
.brand .brand-letter--v{
  margin-right:0.04em;
}
.brand .brand-letter--s{
  margin:0 0.04em;
}
.brand .brand-rest{
  font-size:0.92em;
  letter-spacing:0.01em;
  font-weight:400;
}
.nav nav a{margin-left:16px;color:var(--muted);text-decoration:none;text-shadow:0 2px 6px rgba(0,0,0,.2);}
.nav nav a:hover{color:var(--ink);}
.hero{
  position:relative;
  display:flex;
  align-items:flex-end;
  justify-content:flex-start;
  min-height:100vh;
  padding:120px 56px 64px;
  color:#f7f3ec;
  overflow:hidden;
  margin-top:calc(-1 * var(--nav-stack));
}
main.wrap{padding-top:var(--nav-stack);}
.hero::before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,rgba(10,10,10,.75),rgba(26,24,22,.35));
  z-index:0;
}
.hero-cover{
  background:url("../images/rome-4k-background.jpg") center/cover no-repeat;
}
.hero-content{
  position:relative;
  z-index:1;
  display:flex;
  flex-direction:column;
  gap:18px;
  max-width:none;
  margin:0;
  padding:0;
  align-items:flex-start;
}
.hero h1{
  font-size:clamp(32px,6vw,56px);
  margin:0;
  white-space:nowrap;
}
.hero p{
  margin:0;
  font-size:clamp(18px,3vw,22px);
  color:rgba(244,240,233,.88);
  white-space:nowrap;
}
button#cta{
  background:var(--sand);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:10px 18px;
  cursor:pointer;
  box-shadow:var(--shadow);
}
.foot{border-top:1px solid var(--line);padding:32px;text-align:center;color:var(--muted);}
@media(prefers-color-scheme:dark){
  :root{--paper:#12110f;--sand:#191816;--ink:#f2efe8;--muted:#c0b8a8;--line:#2a2825;}
  body{background:linear-gradient(#0f0e0c,var(--paper));}
}

/* Map gallery */
.map-gallery { padding: 64px 0 40px; background: var(--paper); }
.map-gallery .wrap { position: relative; z-index: 1; }
.gallery-header { display:flex; justify-content:space-between; align-items:center; margin:4px 0 12px; }
.gallery-header h2 { margin:0; }
.controls { display:flex; align-items:center; gap:10px; }
.controls .muted { color:var(--muted); font-size:14px; }
.btn { display:inline-block; padding:8px 12px; border:1px solid var(--line); border-radius:var(--radius); background:var(--sand); cursor:pointer; }
.btn:hover { filter:brightness(.98); }

/* Slides */
.slides { position:relative; overflow:hidden; }
.slide { min-height: 520px; }
.slide:not(.active) { display:none; }
.slide h3 { margin:6px 0 10px; }

/* Map box */
.map { width:100%; height:420px; border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); background:#fff; }
.legend { list-style:none; padding:8px 0 0; margin:0; color:var(--muted); display:flex; gap:16px; }

/* Random / NYT blocks */
.random-page .lead{
  margin:8px 0 28px;
  color:var(--muted);
  max-width:520px;
}
.random-feed{
  display:flex;
  flex-direction:column;
  gap:28px;
  padding-bottom:80px;
}
.nyt-card{
  border-top:3px double var(--line);
  padding-top:24px;
  max-width:640px;
}
.nyt-card__link{
  display:flex;
  flex-direction:column;
  gap:12px;
  color:inherit;
  text-decoration:none;
}
.nyt-card__title{
  font-size:clamp(26px,4vw,34px);
  margin:0;
}
.nyt-card__dek{
  margin:0;
  color:var(--muted);
  line-height:1.7;
}
.nyt-card__cta{
  font-size:14px;
  letter-spacing:0.08em;
  text-transform:uppercase;
  color:var(--accent);
}
.nyt-card__link:hover .nyt-card__cta{
  text-decoration:underline;
}

/* Projects gallery */
.projects-page{
  display:flex;
  flex-direction:column;
  gap:40px;
  padding-bottom:120px;
}
.projects-header{
  display:flex;
  flex-direction:column;
  gap:14px;
  max-width:540px;
}
.projects-lead{
  margin:0;
  color:var(--muted);
  font-size:1.1rem;
  line-height:1.7;
}
.projects-grid{
  display:grid;
  gap:36px;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
}
.projects-grid--two-up{
  grid-template-columns:repeat(2,minmax(0,1fr));
}
.projects-grid--two-up > .project-card:last-child:nth-child(odd){
  grid-column:1 / -1;
}
@media(max-width:880px){
  .projects-grid--two-up{
    grid-template-columns:1fr;
  }
}
.project-card{
  position:relative;
  display:flex;
  flex-direction:column;
  justify-content:flex-end;
  min-height:360px;
  padding:0;
  border-radius:26px;
  overflow:hidden;
  text-decoration:none;
  color:#f4f0e8;
  box-shadow:0 26px 48px rgba(0,0,0,.16);
  transition:transform .45s ease, box-shadow .45s ease;
  isolation:isolate;
}
.project-card img{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  filter:saturate(1.1);
  transform:scale(1.02);
  transition:transform .6s ease, filter .6s ease;
  z-index:-2;
}
.project-card::after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(200deg,rgba(6,5,3,0) 20%,rgba(6,5,3,.8) 100%);
  transition:opacity .45s ease;
  opacity:0;
  z-index:-1;
}
.project-card__overlay{
  position:relative;
  padding:32px 34px;
  display:flex;
  flex-direction:column;
  gap:12px;
  opacity:0;
  visibility:hidden;
  transform:translateY(18px);
  transition:opacity .35s ease, transform .35s ease;
  pointer-events:none;
}
.project-card__tag{
  font-size:12px;
  letter-spacing:.28em;
  text-transform:uppercase;
  color:rgba(244,240,233,.7);
}
.project-card__title{
  margin:0;
  font-size:clamp(26px,4vw,34px);
}
.project-card__desc{
  margin:0;
  max-width:420px;
  color:rgba(244,240,233,.78);
  line-height:1.7;
}
.project-card__cta{
  font-size:14px;
  letter-spacing:.14em;
  text-transform:uppercase;
  color:rgba(244,240,233,.8);
}
.project-card:hover,
.project-card:focus-within{
  transform:translateY(-8px) scale(1.01);
  box-shadow:0 32px 60px rgba(0,0,0,.2);
}
.project-card:hover img,
.project-card:focus-within img{
  transform:scale(1.06);
  filter:saturate(1.2);
}
.project-card:hover::after,
.project-card:focus-within::after{
  opacity:.92;
}
.project-card:hover .project-card__overlay,
.project-card:focus-within .project-card__overlay{
  opacity:1;
  visibility:visible;
  transform:translateY(0);
}
.project-card--light{
  color:#1f1a15;
}
.project-card--light::after{
  background:linear-gradient(200deg,rgba(244,240,233,0) 30%,rgba(244,240,233,.85) 100%);
}
.project-card--light .project-card__tag{
  color:rgba(45,39,31,.6);
}
.project-card--light .project-card__desc{
  color:rgba(40,34,28,.75);
}
.project-card--light .project-card__cta{
  color:rgba(38,32,26,.7);
}

@media(max-width:680px){
  .project-card{
    min-height:280px;
  }
  .project-card__overlay{
    padding:24px 26px;
  }
}

/* Project detail */
.project-detail{
  display:flex;
  flex-direction:column;
  gap:36px;
  padding-bottom:120px;
}
.project-detail__header{
  display:flex;
  flex-direction:column;
  gap:12px;
  max-width:640px;
}
.project-detail__back{
  align-self:flex-start;
  display:inline-flex;
  gap:8px;
  align-items:center;
  text-decoration:none;
  font-size:0.95rem;
  color:var(--muted);
  letter-spacing:0.08em;
  text-transform:uppercase;
}
.project-detail__back:hover{
  color:var(--ink);
}
.project-detail__lead{
  margin:0;
  color:var(--muted);
  font-size:1.05rem;
  line-height:1.7;
}
.project-detail__body{
  display:flex;
  flex-direction:column;
  gap:28px;
}
.project-detail__embed{
  border-radius:28px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,.4);
  box-shadow:0 24px 50px rgba(0,0,0,.12);
  background:#fff;
}
.project-detail__embed gradio-app{
  display:block;
  width:100%;
  min-height:760px;
  border:0;
  background:#fff;
}
.project-detail__embed iframe{
  display:block;
  width:100%;
  height:clamp(760px,90vh,1080px);
  border:0;
  background:#fff;
}
.project-detail__grid{
  display:grid;
  gap:24px;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
}
.project-detail__stack{
  display:flex;
  flex-direction:column;
  gap:32px;
}
.project-detail__grid--stack{
  grid-template-columns:1fr;
  gap:32px;
}
.project-detail__panel{
  background:#fff;
  border-radius:22px;
  padding:24px;
  border:1px solid var(--line);
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  gap:18px;
}
.project-detail__panel--night{
  background:#110b16;
  border-color:rgba(255,215,185,.25);
  color:#f7efe4;
  box-shadow:0 36px 68px rgba(3,2,6,.45);
}
.project-detail__panel--night h2{
  color:#ffe2a8;
}
.project-detail__panel--night iframe{
  background:#05060e;
}
.project-detail__panel h2{
  margin:0;
  font-size:1.15rem;
}
.project-detail__panel iframe{
  width:100%;
  min-height:420px;
  border:0;
  border-radius:16px;
  background:#fff;
}
.project-detail__panel--square iframe{
  aspect-ratio:1 / 1;
  min-height:0;
  height:auto;
}
.project-detail__note{
  margin:0;
  color:var(--muted);
  font-size:0.98rem;
}
.project-detail__note--loud{
  font-size:1.1rem;
}
.project-detail__note a{color:inherit;}
.project-detail__note a:hover{text-decoration:underline;}

/* Essay detail */
.essay-page{
  padding-top:calc(var(--nav-stack) + 56px);
  padding-bottom:120px;
}
.essay{
  background:rgba(255,255,255,.92);
  border-radius:24px;
  box-shadow:0 20px 48px rgba(0,0,0,.12);
  padding:48px clamp(24px,6vw,64px);
  color:#2a2622;
}
.essay-header{
  display:flex;
  flex-direction:column;
  gap:18px;
  margin-bottom:36px;
}
.essay-label{
  text-transform:uppercase;
  letter-spacing:0.24em;
  font-size:12px;
  color:#8c8577;
  margin:0;
}
.essay h1{
  font-size:clamp(30px,5vw,44px);
  margin:0;
}
.essay-subhead{
  margin:0;
  color:#5e5649;
  font-size:18px;
  line-height:1.7;
}
.essay-body{
  display:flex;
  flex-direction:column;
  gap:20px;
  font-size:18px;
  line-height:1.8;
  color:#2e2a26;
}
.essay-body h2,
.essay-body h3,
.essay-body h4{
  margin-top:40px;
  margin-bottom:12px;
  color:#222;
}
.essay-body h3{font-size:24px;}
.essay-body h4{font-size:20px;}
.essay-body p{margin:0;}
.essay-body ul,
.essay-body ol{
  margin:0;
  padding-left:26px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.essay-body table{
  width:100%;
  border-collapse:collapse;
  font-size:16px;
  margin:12px 0;
  background:#f9f7f4;
  border-radius:12px;
  overflow:hidden;
}
.essay-body table th,
.essay-body table td{
  padding:12px 14px;
  border-bottom:1px solid #e0d8ce;
  text-align:left;
}
.essay-body table tr:last-child td{border-bottom:none;}
.essay-body strong{color:#1f1b17;}
.essay-loading,
.essay-error{
  margin:0;
  color:#6d6557;
}

/* Lux gallery */
.lux-page{
  padding-top:var(--nav-stack);
  display:flex;
  flex-direction:column;
  gap:24px;
}
.lux-intro{
  padding:0 var(--gutter) 32px;
}
.lux-intro .lead{
  margin:12px 0 0;
  max-width:560px;
  color:var(--muted);
}
.lux-gallery{
  padding:40px 0 120px;
  background:linear-gradient(to bottom, rgba(18,16,14,.85), rgba(18,16,14,.6));
}
.lux-gallery .wrap{
  max-width:1600px;
}
.lux-grid{
  display:grid;
  gap:8px;
  grid-template-columns:repeat(auto-fit,minmax(460px,1fr));
  grid-auto-rows:20px;
  grid-auto-flow:dense;
}
.lux-piece{
  position:relative;
  overflow:hidden;
  background:#050403;
  isolation:isolate;
  transition:transform .6s ease;
}
.lux-piece img{
  width:100%;
  height:100%;
  display:block;
  object-fit:cover;
  transition:transform .8s ease;
}
.lux-piece::after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(200deg,rgba(8,7,6,0) 20%,rgba(8,7,6,.85) 100%);
  opacity:0;
  transition:opacity .6s ease;
  pointer-events:none;
}
.lux-piece figcaption{
  position:absolute;
  inset:0;
  padding:32px 34px 40px;
  display:flex;
  flex-direction:column;
  justify-content:flex-end;
  gap:10px;
  color:#f5f2ed;
  text-transform:none;
  letter-spacing:.02em;
  z-index:1;
  opacity:0;
  transform:translateY(14px);
  transition:opacity .4s ease, transform .4s ease;
}
.lux-piece__label{
  font-size:12px;
  letter-spacing:.3em;
  text-transform:uppercase;
  color:rgba(244,240,233,.7);
}
.lux-piece__title{
  font-size:24px;
  font-weight:600;
}
.lux-piece__meta{
  font-size:15px;
  color:rgba(244,240,233,.8);
}
.lux-piece:hover{
  transform:scale(1.01);
}
.lux-piece:hover img{
  transform:scale(1.04);
}
.lux-piece:hover::after{
  opacity:1;
}
.lux-piece:hover figcaption{
  opacity:1;
  transform:translateY(0);
}

@media(max-width:900px){
  .lux-grid{
    grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
    grid-auto-rows:18px;
  }
}
@media(max-width:640px){
  .lux-gallery{
    padding:24px 0 80px;
  }
  .lux-grid{
    gap:4px;
    grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
    grid-auto-rows:12px;
  }
  .lux-piece figcaption{
    padding:24px 22px 30px;
  }
}
